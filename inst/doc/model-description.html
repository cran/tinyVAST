<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James T. Thorson" />


<title>tinyVAST model description</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">tinyVAST model description</h1>
<h4 class="author">James T. Thorson</h4>


<div id="TOC">
<ul>
<li><a href="#bivariate-generalized-linear-mixed-model-structure" id="toc-bivariate-generalized-linear-mixed-model-structure">Bivariate
generalized linear mixed model structure</a></li>
<li><a href="#spatial-domains" id="toc-spatial-domains">Spatial
domains</a>
<ul>
<li><a href="#stochastic-partial-differentiaul-equation-spde" id="toc-stochastic-partial-differentiaul-equation-spde">Stochastic
partial differentiaul equation (SPDE)</a></li>
<li><a href="#simultaneous-autoregressive-sar" id="toc-simultaneous-autoregressive-sar">Simultaneous autoregressive
(SAR):</a></li>
<li><a href="#stream-networks-using-a-tail-down-exponential-correlation-function" id="toc-stream-networks-using-a-tail-down-exponential-correlation-function">Stream
networks using a tail-down exponential correlation function</a></li>
</ul></li>
<li><a href="#structural-equation-models" id="toc-structural-equation-models">Structural equation models</a></li>
<li><a href="#dynamic-structural-equation-models" id="toc-dynamic-structural-equation-models">Dynamic structural equation
models</a></li>
<li><a href="#spatial-interactions-for-sem-and-dsem" id="toc-spatial-interactions-for-sem-and-dsem">Spatial interactions for
SEM and DSEM</a></li>
<li><a href="#generalized-additive-model" id="toc-generalized-additive-model">Generalized additive model</a></li>
<li><a href="#spatially-varying-coefficients" id="toc-spatially-varying-coefficients">Spatially varying
coefficients</a></li>
<li><a href="#notation-summary" id="toc-notation-summary">Notation
summary</a></li>
<li><a href="#works-cited" id="toc-works-cited">Works cited</a></li>
</ul>
</div>

<!-- math bold nonitalic -->
<!-- math nonitalic -->
<div id="bivariate-generalized-linear-mixed-model-structure" class="section level1">
<h1>Bivariate generalized linear mixed model structure</h1>
<p>tinyVAST <span class="citation">(J. T. Thorson et al. 2025)</span> is
a bivariate extension of a generalized linear mixed model (see Tables 1
and 2 for notation), which includes two linear predictors that each
include four additive components:</p>
<ol style="list-style-type: decimal">
<li><p><em>Spatial interactions among variables</em>: The user can
specify interactions among variables at a given site (or for spatially
correlated latent variables) using arrow notation derived from path
analysis, based on the interface from R package sem;</p></li>
<li><p><em>Temporal interaction among variables</em>: The user can
specify simultaneous and lagged interactions among variables over time
using an expanded arrow-and-lag notation that is derived from R package
dsem, where these interactions the annual intercept for a given variable
therefore apply uniformly for all locations.</p></li>
<li><p><em>Spatio-temporal interactions among variables</em>: The user
can specify simultaneous and lagged interactions among variables over
time, where these interactions occur on a site-by-site basis.</p></li>
<li><p><em>Generalized additive model</em>: The user specifies a formula
for a generalized additive model (GAM) that is interpreted by R package
mgcv. If other model components are missing, tinyVAST estimates
parameters that are similar to mgcv, with small differences resulting
from different methods for parameter estimation;</p></li>
</ol>
<p>These four components are assembled into two linear predictors:</p>
<p><span class="math display">\[
\begin{aligned}
p_{\mathrm 1,i} &amp;= \underbrace{\mathbf X_{\mathrm 1,i}
\mathbf\alpha_{\mathrm 1} + \mathbf Z_{\mathrm 1,i}
\mathbf\gamma_{\mathrm 1}}_\text{formula} + \underbrace{\mathbf A_{i}
\mathbf\Omega_{\mathrm 1,c[i]}}_\text{space_term} + \underbrace{\mathbf
D_{\mathrm 1,c[i],t[i]}}_\text{time_term} + \underbrace{\mathbf A_i
\mathbf E_{\mathrm 1,c[i],t[i]}}_\text{spacetime_term} +
\underbrace{\mathbf W_{\mathrm 1,i} (\mathbf A_{i} \mathbf\Xi_{\mathrm
1})^{\mathrm T} }_\text{spatially_varying}  \\
p_{\mathrm 2,i} &amp;= \underbrace{\mathbf X_{\mathrm 2,i}
\mathbf\alpha_{\mathrm 2} + \mathbf Z_{\mathrm 2,i}
\mathbf\gamma_{\mathrm 2}}_\text{formula} + \underbrace{\mathbf A_{i}
\mathbf\Omega_{\mathrm 2,c[i]}}_\text{space_term} + \underbrace{\mathbf
D_{\mathrm 2,c[i],t[i]}}_\text{time_term} + \underbrace{\mathbf A_i
\mathbf E_{\mathrm 2,c[i],t[i]}}_\text{spacetime_term} +
\underbrace{\mathbf W_{\mathrm 2,i} (\mathbf A_{i} \mathbf\Xi_{\mathrm
2})^{\mathrm T} }_\text{spatially_varying}
\end{aligned}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(p_{\mathrm 1,i}\)</span> is the first
linear predictor;</li>
<li><span class="math inline">\(\mathbf X_{\mathrm 1,i}
\mathbf\alpha_{\mathrm 1} + \mathbf Z_{\mathrm 1,i}
\mathbf\gamma_{\mathrm 1}\)</span> is the contribution of the GAM
component specified using a formula parsed by package
<code>mgcv</code>;</li>
<li><span class="math inline">\(\mathbf\alpha_{\mathrm 1}\)</span> is
the GAM fixed effects with associated design matrix <span class="math inline">\(\mathbf X_{\mathrm 1}\)</span>, where <span class="math inline">\(\mathbf X_{\mathrm 1,i}\)</span> is the row of the
design matrix for sample <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\mathbf\gamma_{\mathrm 1}\)</span> is
the GAM random effects with associated design matrix <span class="math inline">\(\mathbf Z\)</span>, where <span class="math inline">\(\mathbf Z_{\mathrm 1,i}\)</span> is the row of the
design matrix;</li>
<li><span class="math inline">\(\mathbf A_{i} \mathbf\Omega_{\mathrm
1,c[i]}\)</span> is contribution of the space-veriable interaction <span class="math inline">\(\mathbf\Omega\)</span> projected to sample <span class="math inline">\(i\)</span>, where <span class="math inline">\(\mathbf A\)</span> is the interpolation matrix
with dimension <span class="math inline">\(I \times S\)</span> such that
row <span class="math inline">\(\mathbf A_{i}\)</span> interpolates
spatial vector <span class="math inline">\(\mathbf\Omega_{\mathrm
1,c[i]}\)</span> for sample <span class="math inline">\(i\)</span> and
variable <span class="math inline">\(c[i]\)</span>;</li>
<li><span class="math inline">\(\mathbf D_{\mathrm 1,c[i],t[i]}\)</span>
is the contribution of the time-variable interaction <span class="math inline">\(\mathbf D\)</span> for sample <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\mathbf A_i \mathbf E_{\mathrm
1,c[i],t[i]}\)</span> is the contribution of the space-variable-time
interaction <span class="math inline">\(\mathbf E\)</span> projected to
sample <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\mathbf W_{\mathrm 1,i} \mathbf A_{i}
\mathbf\Xi_{\mathrm 1,c[i]}\)</span> is the contribution of spatially
varying coefficients, i.e., a zero-centered and spatially varying slope
<span class="math inline">\(\Xi_{\mathrm 1,c[i]}\)</span> that is
projected to the location of samples, where these local slopes are then
multiplied by user-supplied covariates in design matrix <span class="math inline">\(W_{\mathrm 1,i}\)</span></li>
</ul>
<p>and terms are defined similarly for the second linear predictor <span class="math inline">\(p_{\mathrm 2,i}\)</span> except using subscript-2.
The linear predictors are then passed through a bivariate inverse-link
function to specify the distribution for errors:</p>
<p><span class="math display">\[
y_i \sim f_{e[i]}( g_{e[i]}^{-1} (p_{\mathrm 1,i}, p_{\mathrm 2,i}),
\theta_{e[i]} )
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(f_{e[i]}\)</span> probability density or
mass function for sample <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(g_{e[i]}^{-1} (p_{\mathrm 1,i},
p_{\mathrm 2,i})\)</span> is the bivariate inverse-link function that
transforms linear predictors to the central tendancy parameters of the
distribution;</li>
<li><span class="math inline">\(\theta_{e[i]}\)</span> is the dispersion
parameters for distribution <span class="math inline">\(e[i]\)</span>
for sample <span class="math inline">\(i\)</span>;</li>
</ul>
<p>In the simple case, the distribution only requires a single linear
predictor such that <span class="math inline">\(\mathbf p_{\mathrm 2} =
\mathbf 0\)</span> by construction and drops out of the model. In this
case, the model collapses to a generalized linear mixed model. For
example we might have a log-link and Poisson distribution, such that it
collapses to a log-linked Poisson GLMM, <span class="math inline">\(y_i
\sim \mathrm{Poisson}(e^{p_{\mathrm 1,i}})\)</span>.</p>
<p>However, tinyVAST can also handle a delta-model using either
logit-log or Poisson-linked link functions:</p>
<p><span class="math display">\[
g_{e[i]}^{-1} (p_{\mathrm 1,i}, p_{\mathrm 2,i}) = ( \mu_{\mathrm 1,i},
\mu_{\mathrm 2,i}  )
\]</span></p>
<p>where <span class="math inline">\(\mu_{\mathrm 1,i}\)</span> and
<span class="math inline">\(\mu_{\mathrm 2,i}\)</span> are the two
linear predictors, such that <span class="math inline">\(\mathbb{E}[y_i]
= \mu_{\mathrm 1,i} \mu_{\mathrm 2,i}\)</span>;</p>
<p>For the conventional logit-log bivariate link function we use a
logit-link for encounter probabilities and a log-link for positive catch
rates:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_{\mathrm 1,i} &amp;= \frac{e^{p_{\mathrm 1,i}}}{1+e^{p_{\mathrm
1,i}}}  \\
\mu_{\mathrm 2,i} &amp;= e^{p_{\mathrm 2,i}}
\end{aligned}
\]</span></p>
<p>while for the Poisson-linked link function <span class="citation">(J.
T. Thorson 2018)</span> we specify a complemetary log-log link for
encounter probabilities and define the second link function such that
<span class="math inline">\(\mu_{\mathrm 1,i} \mu_{\mathrm 2,i} =
e^{p_{\mathrm 1,i}} e^{p_{\mathrm 2,i}}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_{\mathrm 1,i} &amp;= 1 - e^{-e^{p_{\mathrm 1,i}}} \\
\mu_{\mathrm 2,i} &amp;= \frac{e^{p_{\mathrm 1,i}}}{\mu_{\mathrm 1,i}}
e^{p_{\mathrm 2,i}}
\end{aligned}
\]</span> where <span class="math inline">\(e^{p_{\mathrm 1,i}}\)</span>
is the density for an underlying point process, and <span class="math inline">\(e^{p_{\mathrm 2,i}}\)</span> is biomass per point
(i.e., animal or group).</p>
<p>In either the conventional or Poisson-linked delta model, <span class="math inline">\(\mu_{\mathrm 1,i} = \mathrm{Pr}(Y&gt;0)\)</span>
is the encounter probability (and is fitted with a Bernoulli
distribution), while <span class="math inline">\(\mu_{\mathrm
2,i}\)</span> is the central tendancy for positive values, i.e., <span class="math inline">\(\mu_{\mathrm 2,i} = \mathbb{E}(Y |
Y&gt;0)\)</span>.</p>
<p>Usefully, the interface allows analysts to specify a different
distribution <span class="math inline">\(e_i\)</span> for different
partitions of the data. This allows the model to jointly analyze
different data types <span class="citation">(Grüss and Thorson
2019)</span>, or data with different magnitudes of sampling error.</p>
</div>
<div id="spatial-domains" class="section level1">
<h1>Spatial domains</h1>
<p>Linear predictors include spatially autocorrelated latent variables.
These variables are treated as Gaussian Markov random fields (GMRFs),
and evaluating the probability density of GMRFs involves calculating the
precision matrix <span class="math inline">\(\mathbf Q_{\mathrm{domain}}
= \mathbf\Sigma^{-1}\)</span> as the inverse of the spatial covariance
matrix <span class="citation">(J. Thorson and Kristensen 2024)</span>.
tinyVAST involves three options for specifying this spatial
precision:</p>
<div id="stochastic-partial-differentiaul-equation-spde" class="section level3">
<h3>Stochastic partial differentiaul equation (SPDE)</h3>
<p>The analyst can approximate spatial variation over a continuous
two-dimensional surface by constructing finite element mesh (FEM),
treating the value at vertices as a GMRF, and then using bilinear
interpolation (i.e., a piecewise linear approximation) to interpolate
from vertices to the spatial domain. This method was developed by <span class="citation">(F. Lindgren, Rue, and Lindström 2011)</span>, as
popularized in the software R-INLA <span class="citation">(Lindgren
2012)</span>, first implemented in TMB by <span class="citation">(J. T.
Thorson et al. 2014)</span>, and using elements constructed by R-package
<code>fmesher</code> <span class="citation">(F. Lindgren 2023)</span>.
In this case, the precision is constructed as:</p>
<p><span class="math display">\[
\mathbf Q_{\mathrm{domain}} = \tau^2 ( \kappa^4 \mathbf M_{\mathrm 0} +
2\kappa^2 \mathbf M_{\mathrm 1} + \mathbf M_{\mathrm 2} )
\]</span> where every row <span class="math inline">\(\mathbf
A_i\)</span> of the interpolation matrix <span class="math inline">\(\mathbf A\)</span> is nonzero for only the three
vertices of the triangle that contains sample <span class="math inline">\(i\)</span></p>
</div>
<div id="simultaneous-autoregressive-sar" class="section level3">
<h3>Simultaneous autoregressive (SAR):</h3>
<p>Alternatively, the analyst can apply a simultaneous autoregressive
process <span class="citation">(Ver Hoef, Hanks, and Hooten
2018)</span>, specifying an areal model that represents the value within
spatial strata:</p>
<p><span class="math display">\[
\mathbf Q_{\mathrm{domain}} = \tau^2 (\mathbf I - \kappa \mathbf A^*)^2
\]</span> where <span class="math inline">\(\mathbf A^*\)</span> is the
adjacency matrix of the graph specified by the analyst, <span class="math inline">\(\kappa\)</span> is the estimated partial
correlation between adjacent areas, and each row <span class="math inline">\(\mathbf A_i\)</span> of interpolation matrix <span class="math inline">\(\mathbf A\)</span> is nonzero only for the single
spatial stratum containing sample <span class="math inline">\(i\)</span>
(and noting that adjacency matrix <span class="math inline">\(\mathbf
A^*\)</span> is different from interpolation matrix <span class="math inline">\(\mathbf A\)</span>, but we use the same notation
for both due to a collision in notational standards).</p>
</div>
<div id="stream-networks-using-a-tail-down-exponential-correlation-function" class="section level3">
<h3>Stream networks using a tail-down exponential correlation
function</h3>
<p>Finally, the analyst can specify that sites are partially correlated
if they are adjacent along a stream network (while ignoring flow
direction). This results in an Onstein-Uhlenbeck process along the
stream network <span class="citation">(Charsley et al. 2023)</span>, or
an <em>exponential tail-down</em> model:</p>
<p><span class="math display">\[
\mathbf{Q}_{\mathrm{domain}} = \mathbf{(I+D-P)}^T \mathbf{I+D}^{-1}
\mathbf{(I+D-P)}
\]</span> where <span class="math inline">\(\mathbf D\)</span> is a
sparse diagonal matrix with diagonal elements</p>
<p><span class="math display">\[
d_{i,j} =\mathrm{exp}(-2 \theta |\mathbf s_i, \mathbf s_j|) / (1 -
\mathrm{exp}(-2 \theta |\mathbf s_i, \mathbf s_j|))
\]</span> where <span class="math inline">\(|\mathbf s_i, \mathbf
s_j|\)</span> is the distance from downstream (parent) node <span class="math inline">\(j\)</span> to upstream (child) node <span class="math inline">\(i\)</span>, and <span class="math inline">\(\theta\)</span> is the O-U parameter governing the
decorrelation rate. Similarly, <span class="math inline">\(\mathbf
P\)</span> is a sparse matrix containing values <span class="math inline">\(\rho_{i,j}\)</span>, where: <span class="math display">\[
\rho_{i,j} = \mathrm{exp}(-\theta |\mathbf s_i, \mathbf s_j|) / (1 -
\mathrm{exp}(-2 \theta |\mathbf s_i, \mathbf s_j|))
\]</span> such that <span class="math inline">\(\rho_{i,j}\)</span> the
regression slope predicting upstream node <span class="math inline">\(i\)</span> from downstream node <span class="math inline">\(j\)</span>. The spatial interpolation matrix <span class="math inline">\(\mathbf A\)</span> again has row <span class="math inline">\(\mathbf A_i\)</span> for each sampling or
predictive location, and <span class="math inline">\(\mathbf
A_i\)</span> is nonzero for the two nodes immediately up and downstream
from a given location, with values such that a given location is
predicted as a weighted average based upon the distance from those two
nodes.</p>
<p>For the SPDE and SAR spatial domains, the term <span class="math inline">\(\tau\)</span> is defined such that precision <span class="math inline">\(\mathbf Q_{\mathrm{domain}}\)</span> has unit
variance. This is done because the spatial domain always arises in
combination with other parameters, which are used to define the variance
of the associated spatial variable.</p>
</div>
</div>
<div id="structural-equation-models" class="section level1">
<h1>Structural equation models</h1>
<p>tinyVAST also involves specifying a structural equation model (SEM).
This SEM be viewed either:</p>
<ol style="list-style-type: decimal">
<li><em>Weak interpretation</em>: as an expressive interface to
parameterize the correlation among variables, using as many or few
parameters as might be appropriate; or</li>
<li><em>Strong interpretation</em>: as a structural causal model,
allowing predictions about the consequence of counterfactual changes to
the system.</li>
</ol>
<p>To specify a SEM, the user uses <em>arrow notation</em> derived from
package <code>sem</code> <span class="citation">(Fox 2006)</span>, as
described in TMB by <span class="citation">(J. Thorson and Kristensen
2024)</span>. For example, to specify a linear model this involves:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w2, b_12</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>w1 <span class="ot">&lt;-</span><span class="er">&gt;</span> w1, sd_1</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>w2 <span class="ot">&lt;-</span><span class="er">&gt;</span> w2, sd_2</span></code></pre></div>
<p>This then estimates a single slope parameter (represented with a
one-headed arrow), as well as the variance of <span class="math inline">\(W_1\)</span> and <span class="math inline">\(W_2\)</span> (specified with two-headed arrows).
In a more complicated case, <span class="math inline">\(W_1\)</span>
might cause <span class="math inline">\(W_2\)</span>, which in turn
causes <span class="math inline">\(W_3\)</span>. This is then
represented as:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Path, parameter_name, start value</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w2, b_12, <span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>w2 <span class="ot">-&gt;</span> w3, b_23, <span class="dv">0</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>w1 <span class="ot">&lt;-</span><span class="er">&gt;</span> w1, s_1, <span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>w2 <span class="ot">&lt;-</span><span class="er">&gt;</span> w2, s_2, <span class="dv">1</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>w3 <span class="ot">&lt;-</span><span class="er">&gt;</span> w3, s_3, <span class="dv">1</span></span></code></pre></div>
<p>SEM interactions can be as complicated or simple as desired, and can
include:</p>
<ol style="list-style-type: decimal">
<li>Latent variables and loops (i.e., they are not restricted to
directed acyclic graphs);</li>
<li>Values that are fixed a priori, where the
<code>parameter_name</code> is provided as <code>NA</code> and the
starting value that follows is the fixed value;</li>
<li>Values that are mirrored among path coefficients, where the same
<code>parameter_name</code> is provided for multiple rows of the text
file.</li>
</ol>
<p>In this preceding example, path coefficients for one-headed arrows
then define path matrix <span class="math inline">\(\mathbf
P\)</span>:</p>
<p><span class="math display">\[
\mathbf P =
\begin{pmatrix}
  0 &amp; 0 &amp; 0 \\
  b_{12} &amp; 0 &amp; 0 \\
  0 &amp; b_{23} &amp; 0
\end{pmatrix}
\]</span></p>
<p>and coefficents for two-headed arrows define the Cholesky <span class="math inline">\(\mathbf G\)</span> of the exnogenous covariance
matrix <span class="math inline">\(\mathbf G^T \mathbf G\)</span>:</p>
<p><span class="math display">\[
\mathbf G =
\begin{pmatrix}
  s_{1} &amp; 0 &amp; 0 \\
  0 &amp; s_{2} &amp; 0 \\
  0 &amp; 0 &amp; s_{3}
\end{pmatrix}
\]</span></p>
<p>These matrices are define a simultaneous equation model:</p>
<p><span class="math display">\[
\mathbf{ w = P w + \epsilon} \\
\mathbf\epsilon \sim \mathrm{MVN}( \mathbf 0, \mathbf G^T \mathbf G )
\]</span> where the variance <span class="math inline">\(\mathrm{Var}(\mathbf w) = (\mathbf{I - P})^{-1}
\mathbf G^2 (\mathbf{I - P}^T)^{-1}\)</span>. This then results in a
sparse precision matrix:</p>
<p><span class="math display">\[
\mathbf Q = (\mathbf{I - P}^T) \mathbf G^{-1} \mathbf G^{-T} (\mathbf{I
- P})
\]</span></p>
<p>where this precision matrix <span class="math inline">\(\mathbf
Q\)</span> is then used as a modular component in the larger tinyVAST
model.</p>
</div>
<div id="dynamic-structural-equation-models" class="section level1">
<h1>Dynamic structural equation models</h1>
<p>Similarly, tinyVAST involves specifying dynamic structural equation
models (DSEM) <span class="citation">(J. T. Thorson et al. 2024)</span>.
To specify a DSEM, the user uses <em>arrow-and-lag notation</em>. For
example, to specify a univariate first-order autoregressive process:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>w1 <span class="ot">-&gt;</span> w1, <span class="dv">1</span>, rho, <span class="fl">0.8</span></span></code></pre></div>
<p>If there were four time-intervals (<span class="math inline">\(T=4\)</span>) this would then result in the path
matrix:</p>
<p><span class="math display">\[
\mathbf P =
\begin{pmatrix}
  0 &amp; 0 &amp; 0 &amp; 0 \\
  \rho &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; \rho &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; \rho &amp; 0
\end{pmatrix}
\]</span></p>
<p>and when the DSEM involves multiple times and variables, the sparse
precision is formed by summing across the Kronecker product of time-lag
and interaction matrices. This DSEM defines a GMRF over a nonseparable
interaction of time and variables, represented by a matrix <span class="math inline">\(\mathbf Q_{\mathrm{time\_term}}\)</span> with
dimension <span class="math inline">\(CT \times CT\)</span>. The user
can specify a separate <em>arrow-and-lag</em> notation to define the
precision matrix for the time-variable interaction <span class="math inline">\(\mathbf Q_{\mathrm{time\_term}}\)</span> and for
the space-time-variable interaction <span class="math inline">\(\mathbf
Q_{\mathrm{spacetime\_term}}\)</span>.</p>
<p>The precision matrix <span class="math inline">\(\mathbf
Q_{\mathrm{time\_term}}\)</span> for the time term <span class="math inline">\(\mathbf D\)</span> is used to define the
time-varying intercept for each variable:</p>
<p><span class="math display">\[
\mathrm{vec}(\mathbf D) \sim \mathrm{MVN}(\mathbf 0, \mathbf
Q_{\mathrm{time\_term}})
\]</span> Meanwhile, the space-time term <span class="math inline">\(\mathbf Q_{\mathrm{spacetime\_term}}\)</span> is
combined with the spatial precision <span class="math inline">\(\mathbf
Q_{\mathrm{space\_term}}\)</span> as we explain next.</p>
</div>
<div id="spatial-interactions-for-sem-and-dsem" class="section level1">
<h1>Spatial interactions for SEM and DSEM</h1>
<p>tinyVAST uses the SEM and DSEM notation to construct the joint
precision for the space-variable interaction <span class="math inline">\(\mathbf\Omega\)</span> with dimension <span class="math inline">\(S \times C\)</span>, and the space-time-variable
interaction <span class="math inline">\(\mathbf E\)</span> with
dimension <span class="math inline">\(S \times C \times T\)</span>. To
do so, it constructs the separable precision for each process:</p>
<p><span class="math display">\[
\mathrm{vec}(\mathbf E) \sim \mathrm{MVN}(\mathbf 0, \mathbf
Q_{\mathrm{spacetime\_term}} \otimes \mathbf Q_{\mathrm{domain}})
\]</span></p>
<p>where the precision matrix <span class="math inline">\(\mathbf
Q_{\mathrm{spacetime\_term}} \otimes \mathbf
Q_{\mathrm{domain}}\)</span> has dimension <span class="math inline">\(STC \times STC\)</span> to match the length of
<span class="math inline">\(\mathrm{vec}(\mathbf E)\)</span>, and <span class="math display">\[
\mathrm{vec}(\mathbf\Omega) \sim \mathrm{MVN}(\mathbf 0, \mathbf
Q_{\mathrm{space\_term}} \otimes \mathbf Q_{\mathrm{domain}})
\]</span></p>
<p>where the precision matrix <span class="math inline">\(\mathbf
Q_{\mathrm{space\_term}} \otimes \mathbf Q_{\mathrm{domain}}\)</span>
has dimension <span class="math inline">\(SC \times SC\)</span>, to
match the length of <span class="math inline">\(\mathrm{vec}(\mathbf\Omega)\)</span>. This
specification generalizes spatial factor analysis <span class="citation">(Thorson et al. 2015)</span> and spatial dynamic factor
analysis <span class="citation">(J. T. Thorson et al. 2016)</span>.</p>
</div>
<div id="generalized-additive-model" class="section level1">
<h1>Generalized additive model</h1>
<p>The analyst can specify a generalized additive model using syntax
from package <code>mgcv</code> <span class="citation">(Wood
2006)</span>, and parsed into TMB using an interface developed by
<code>sdmTMB</code> <span class="citation">(Anderson et al.
n.d.)</span>. For example this might involve:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>count <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">offset</span>(log_area) <span class="sc">+</span> <span class="fu">s</span>(depth) <span class="sc">+</span> <span class="fu">s</span>(species, <span class="at">bs=</span><span class="st">&quot;re&quot;</span>)</span></code></pre></div>
<p>If <code>year</code> and <code>species</code> are factors and
<code>depth</code> and <code>log_area</code> are continuous, then this
would specify a fixed effect for each level <code>year</code>, a spline
smoother for <code>depth</code>, using <code>log_area</code> as an
offset, and estimating a random intercept for each level of
<code>species</code>. This formula is parsed internally to assemble
fixed effects in design matrix <span class="math inline">\(\mathbf
X\)</span> and the basis functions for spline smoothers and random
effects in design matrix <span class="math inline">\(\mathbf Z\)</span>.
The coefficients <span class="math inline">\(\mathbf\gamma\)</span>
associated with smoothers and random effects are then specified to
follow a GMRF:</p>
<p><span class="math display">\[
\mathbf\gamma \sim \mathrm{GMRF}( \mathbf 0, \mathbf Q_{\mathrm{gam}})
\]</span> where <span class="math inline">\(\mathbf
Q_{\mathrm{gam}}\)</span> is a blockwise diagonal matrix, assembled from
estimated variance parameters and matrices constructed by mgcv.</p>
</div>
<div id="spatially-varying-coefficients" class="section level1">
<h1>Spatially varying coefficients</h1>
<p>Finally, the analyst can account for spatial variation in the
relationship between a specified covariate and the estimated response.
This is done by specifying a spatially varying coefficient (SVC) <span class="citation">(J. T. Thorson et al. 2023)</span>, and this can be
used e.g. to account for spatially varying differences in
catchability/detectability <span class="citation">(Grüss et al.
2023)</span> or to account for nonlocal impacts of regional
oceanographic indices <span class="citation">(J. T. Thorson
2019)</span>. This involves estimating each SVC <span class="math inline">\(l \in \{1,2,...,L\}\)</span> as a zero-centered
Gaussian Markov random field while estimating its corresponding variance
<span class="math inline">\(\sigma_{\mathrm{\xi},l}^2\)</span>:</p>
<p><span class="math display">\[
\Xi_{\mathrm 1,l} \sim \mathrm{GMRF}( \mathbf 0,
\sigma_{\mathrm{\xi},l}^{-2} \mathbf Q_{\mathrm{domain}} )
\]</span></p>
<p>Any covariate specified as an SVC it is also typically specified in
the <code>formula</code> to estimate a non-zero mean for the SVC. If the
estimated variance of the SVC approaches zero, it then suggests that the
covariate slope does not vary spatially.</p>
</div>
<div id="notation-summary" class="section level1">
<h1>Notation summary</h1>
<table>
<caption>Table 1: Subscript notation</caption>
<thead>
<tr class="header">
<th align="left">Symbol</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(i\)</span></td>
<td align="left">Index for each sample, <span class="math inline">\(i\)</span> in <span class="math inline">\((1,2,...,I)\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(s[i]\)</span></td>
<td align="left">spatial coordinate for sample <span class="math inline">\(i\)</span>, <span class="math inline">\(s\)</span>
in <span class="math inline">\((1,2,...,S)\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(t[i]\)</span></td>
<td align="left">time-interval for sample <span class="math inline">\(i\)</span>, <span class="math inline">\(t\)</span>
in <span class="math inline">\((1,2,...,T)\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(c[i]\)</span></td>
<td align="left">category for sample <span class="math inline">\(i\)</span>, <span class="math inline">\(c\)</span>
in <span class="math inline">\((1,2,...,C)\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(e[i]\)</span></td>
<td align="left">error distribution and link function for sample <span class="math inline">\(i\)</span></td>
</tr>
</tbody>
</table>
<table>
<caption>Table 2: Symbol notation, code representation (in model output
or in model template code), and descriptions.</caption>
<thead>
<tr class="header">
<th align="left">Symbol</th>
<th align="left">Code</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(y\)</span></td>
<td align="left"><code>y_i</code></td>
<td align="left">Observed response data</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(p_1\)</span></td>
<td align="left"><code>p_i</code></td>
<td align="left">first linear predictor</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(p_2\)</span></td>
<td align="left"><code>p2_i</code></td>
<td align="left">second linear predictor</td>
</tr>
</tbody>
</table>
</div>
<div id="works-cited" class="section level1 unnumbered">
<h1 class="unnumbered">Works cited</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-anderson_sdmtmb_nodate" class="csl-entry">
Anderson, Sean C., Eric J. Ward, Philina A. English, Lewis A. K.
Barnett, and James T. Thorson. n.d. <span>“<span class="nocase">sdmTMB</span>: <span>An</span> <span>R</span>
<span>Package</span> for <span>Fast</span>, <span>Flexible</span>, and
<span>User</span>-<span>Friendly</span> <span>Generalized</span>
<span>Linear</span> <span>Mixed</span> <span>Effects</span>
<span>Models</span> with <span>Spatial</span> and
<span>Spatiotemporal</span> <span>Random</span>
<span>Fields</span>.”</span> <em>Journal of Open Source Software</em>.
Accessed March 10, 2025. <a href="https://doi.org/10.1101/2022.03.24.485545">https://doi.org/10.1101/2022.03.24.485545</a>.
</div>
<div id="ref-charsley_catchment-scale_2023" class="csl-entry">
Charsley, Anthony R., Arnaud Grüss, James T. Thorson, Merrill B. Rudd,
Shannan K. Crow, Bruno David, Erica K. Williams, and Simon D. Hoyle.
2023. <span>“Catchment-Scale Stream Network Spatio-Temporal Models,
Applied to the Freshwater Stages of a Diadromous Fish Species, Longfin
Eel (<span>Anguilla</span> Dieffenbachii).”</span> <em>Fisheries
Research</em> 259 (March): 106583. <a href="https://doi.org/10.1016/j.fishres.2022.106583">https://doi.org/10.1016/j.fishres.2022.106583</a>.
</div>
<div id="ref-fox_structural_2006" class="csl-entry">
Fox, John. 2006. <span>“Structural Equation Modeling with the Sem
Package in <span>R</span>.”</span> <em>Structural Equation Modeling-a
Multidisciplinary Journal</em> 13: 465–86.
</div>
<div id="ref-gruss_developing_2019" class="csl-entry">
Grüss, Arnaud, and James T. Thorson. 2019. <span>“Developing
Spatio-Temporal Models Using Multiple Data Types for Evaluating
Population Trends and Habitat Usage.”</span> <em>ICES Journal of Marine
Science</em> 76 (6): 1748–61. <a href="https://doi.org/10.1093/icesjms/fsz075">https://doi.org/10.1093/icesjms/fsz075</a>.
</div>
<div id="ref-gruss_spatially_2023" class="csl-entry">
Grüss, Arnaud, James T. Thorson, Owen F. Anderson, Richard L.
O’Driscoll, Madison Heller-Shipley, and Scott Goodman. 2023.
<span>“Spatially Varying Catchability for Integrating Research Survey
Data with Other Data Sources: Case Studies Involving Observer Samples,
Industry-Cooperative Surveys, and Predators as Samplers.”</span>
<em>Canadian Journal of Fisheries and Aquatic Sciences</em> 80 (10):
1595–615. <a href="https://doi.org/10.1139/cjfas-2023-0051">https://doi.org/10.1139/cjfas-2023-0051</a>.
</div>
<div id="ref-lindgren_continuous_2012" class="csl-entry">
Lindgren. 2012. <span>“Continuous Domain Spatial Models in
<span>R</span>-<span>INLA</span>.”</span> <em>The ISBA Bulletin</em> 19
(4): 14–20.
</div>
<div id="ref-lindgren_fmesher_2023" class="csl-entry">
Lindgren, Finn. 2023. <span>“Fmesher: <span>Triangle</span>
<span>Meshes</span> and <span>Related</span> <span>Geometry</span>
<span>Tools</span>.”</span> <a href="https://CRAN.R-project.org/package=fmesher">https://CRAN.R-project.org/package=fmesher</a>.
</div>
<div id="ref-lindgren_explicit_2011" class="csl-entry">
Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. <span>“An
Explicit Link Between <span>Gaussian</span> Fields and
<span>Gaussian</span> <span>Markov</span> Random Fields: The Stochastic
Partial Differential Equation Approach.”</span> <em>Journal of the Royal
Statistical Society: Series B (Statistical Methodology)</em> 73 (4):
423–98. <a href="https://doi.org/10.1111/j.1467-9868.2011.00777.x">https://doi.org/10.1111/j.1467-9868.2011.00777.x</a>.
</div>
<div id="ref-thorson_three_2018" class="csl-entry">
Thorson, James T. 2018. <span>“Three Problems with the Conventional
Delta-Model for Biomass Sampling Data, and a Computationally Efficient
Alternative.”</span> <em>Canadian Journal of Fisheries and Aquatic
Sciences</em> 75 (9): 1369–82. <a href="https://doi.org/10.1139/cjfas-2017-0266">https://doi.org/10.1139/cjfas-2017-0266</a>.
</div>
<div id="ref-thorson_measuring_2019" class="csl-entry">
———. 2019. <span>“Measuring the Impact of Oceanographic Indices on
Species Distribution Shifts: <span>The</span> Spatially Varying Effect
of Cold-Pool Extent in the Eastern <span>Bering</span>
<span>Sea</span>.”</span> <em>Limnology and Oceanography</em> 64 (6):
2632–45. <a href="https://doi.org/10.1002/lno.11238">https://doi.org/10.1002/lno.11238</a>.
</div>
<div id="ref-thorson_tinyvast_2025" class="csl-entry">
Thorson, James T., Sean C. Anderson, Pamela Goddard, and Christopher N.
Rooper. 2025. <span>“<span class="nocase">tinyVAST</span>:
<span>R</span> <span>Package</span> <span>With</span> an
<span>Expressive</span> <span>Interface</span> to <span>Specify</span>
<span>Lagged</span> and <span>Simultaneous</span> <span>Effects</span>
in <span>Multivariate</span> <span>Spatio</span>-<span>Temporal</span>
<span>Models</span>.”</span> <em>Global Ecology and Biogeography</em> 34
(4): e70035. <a href="https://doi.org/10.1111/geb.70035">https://doi.org/10.1111/geb.70035</a>.
</div>
<div id="ref-thorson_dynamic_2024" class="csl-entry">
Thorson, James T., Alexander G. Andrews III, Timothy E. Essington, and
Scott I. Large. 2024. <span>“Dynamic Structural Equation Models
Synthesize Ecosystem Dynamics Constrained by Ecological
Mechanisms.”</span> <em>Methods in Ecology and Evolution</em> 15 (4):
744–55. <a href="https://doi.org/10.1111/2041-210X.14289">https://doi.org/10.1111/2041-210X.14289</a>.
</div>
<div id="ref-thorson_spatially_2023" class="csl-entry">
Thorson, James T., Cheryl L. Barnes, Sarah T. Friedman, Janelle L.
Morano, and Margaret C. Siple. 2023. <span>“Spatially Varying
Coefficients Can Improve Parsimony and Descriptive Power for Species
Distribution Models.”</span> <em>Ecography</em> 2023 (5): e06510. <a href="https://doi.org/10.1111/ecog.06510">https://doi.org/10.1111/ecog.06510</a>.
</div>
<div id="ref-thorson_joint_2016" class="csl-entry">
Thorson, James T., James N. Ianelli, Elise A. Larsen, Leslie Ries, Mark
D. Scheuerell, Cody Szuwalski, and Elise F. Zipkin. 2016. <span>“Joint
Dynamic Species Distribution Models: A Tool for Community Ordination and
Spatio-Temporal Monitoring.”</span> <em>Global Ecology and
Biogeography</em> 25 (9): 1144–58. <a href="https://doi.org/10.1111/geb.12464">https://doi.org/10.1111/geb.12464</a>.
</div>
<div id="ref-thorson_importance_2014" class="csl-entry">
Thorson, James T., Hans J. Skaug, Kasper Kristensen, Andrew O. Shelton,
Eric J. Ward, John H. Harms, and James A. Benante. 2014. <span>“The
Importance of Spatial Models for Estimating the Strength of Density
Dependence.”</span> <em>Ecology</em> 96 (5): 1202–12. <a href="https://doi.org/10.1890/14-0739.1">https://doi.org/10.1890/14-0739.1</a>.
</div>
<div id="ref-thorson_spatio-temporal_2024" class="csl-entry">
Thorson, James, and Kasper Kristensen. 2024.
<em>Spatio-<span>Temporal</span> <span>Models</span> for
<span>Ecologists</span></em>. 1st edition. Boca Raton, FL: Chapman;
Hall/CRC.
</div>
<div id="ref-thorson_spatial_2015" class="csl-entry">
Thorson, Mark D. Scheuerell, Andrew O. Shelton, Kevin E. See, Hans J.
Skaug, and Kasper Kristensen. 2015. <span>“Spatial Factor Analysis: A
New Tool for Estimating Joint Species Distributions and Correlations in
Species Range.”</span> <em>Methods in Ecology and Evolution</em> 6 (6):
627–37. <a href="https://doi.org/10.1111/2041-210X.12359">https://doi.org/10.1111/2041-210X.12359</a>.
</div>
<div id="ref-ver_hoef_relationship_2018" class="csl-entry">
Ver Hoef, Jay M., Ephraim M. Hanks, and Mevin B. Hooten. 2018. <span>“On
the Relationship Between Conditional (<span>CAR</span>) and Simultaneous
(<span>SAR</span>) Autoregressive Models.”</span> <em>Spatial
Statistics</em> 25 (June): 68–85. <a href="https://doi.org/10.1016/j.spasta.2018.04.006">https://doi.org/10.1016/j.spasta.2018.04.006</a>.
</div>
<div id="ref-wood_generalized_2006" class="csl-entry">
Wood, S. N. 2006. <em>Generalized Additive Models: An Introduction with
<span>R</span></em>. 1st ed. Boca Raton, FL: Chapman; Hall/CRC Press.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
